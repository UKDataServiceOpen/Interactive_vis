#!/bin/bash

# Install system dependencies
apt-get update -y
apt-get install -y libudunits2-dev libgdal-dev libgeos-dev libproj-dev

# Debugging: Confirm installation of system dependencies
echo "Checking if libudunits2 is installed..."
ldconfig -p | grep libudunits2

echo "Checking if libgdal is installed..."
ldconfig -p | grep libgdal

echo "Checking if libgeos is installed..."
ldconfig -p | grep libgeos

echo "Checking if libproj is installed..."
ldconfig -p | grep libproj

# Set environment variables to help R locate the installed libraries
export UDUNITS2_INCLUDE=$(udunits2-config --includedir)
export UDUNITS2_LIBS=$(udunits2-config --libdir)
export LD_LIBRARY_PATH=$LD_LIBRARY_PATH:/usr/lib:/usr/local/lib

# Debugging: Display environment variables
echo "UDUNITS2_INCLUDE: $UDUNITS2_INCLUDE"
echo "UDUNITS2_LIBS: $UDUNITS2_LIBS"
echo "LD_LIBRARY_PATH: $LD_LIBRARY_PATH"

# Execute the R script
Rscript install.r